<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="763px" preserveAspectRatio="none" style="width:1078px;height:763px;background:#FEFEFE;" version="1.1" viewBox="0 0 1078 763" width="1078px" zoomAndPan="magnify"><defs/><g><rect fill="#FEFEFE" height="763" style="stroke:none;stroke-width:1;" width="1078" x="0" y="0"/><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="488.6563" style="stroke:#000000;stroke-width:1;" width="10" x="334.7173" y="98.4297"/></g><g><title>JpaPortfolioAdapter</title><rect fill="#FFFFFF" height="364.9922" style="stroke:#000000;stroke-width:1;" width="10" x="512.5889" y="192.9609"/></g><g><title>PortfolioMapper</title><rect fill="#FFFFFF" height="139.9297" style="stroke:#000000;stroke-width:1;" width="10" x="679.7725" y="272.3594"/></g><g><title>PortfolioRepository</title><rect fill="#FFFFFF" height="87.3984" style="stroke:#000000;stroke-width:1;" width="10" x="845.8008" y="441.4219"/></g><g><title>PostgreSQL</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="982.7593" y="470.5547"/></g><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="Service" id="part1-lifeline"><g><title>PortfolioStockOperationsService</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="135.7725" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="139" x2="139" y1="67.2969" y2="685.6172"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="Port" id="part2-lifeline"><g><title>PortfolioPort</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="335.7173" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="339.5449" x2="339.5449" y1="67.2969" y2="685.6172"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="Adapter" id="part3-lifeline"><g><title>JpaPortfolioAdapter</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="513.5889" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="516.8516" x2="516.8516" y1="67.2969" y2="685.6172"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="Mapper" id="part4-lifeline"><g><title>PortfolioMapper</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="680.7725" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="684.3262" x2="684.3262" y1="67.2969" y2="685.6172"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="Repo" id="part5-lifeline"><g><title>PortfolioRepository</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="846.8008" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="850.2188" x2="850.2188" y1="67.2969" y2="685.6172"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="DB" id="part6-lifeline"><g><title>PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="618.3203" width="8" x="983.7593" y="67.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="987.3828" x2="987.3828" y1="67.2969" y2="685.6172"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="Service" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="239.5449" x="20" y="36"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="225.5449" x="27" y="55.9951">PortfolioStockOperationsService</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="Service" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="239.5449" x="20" y="684.6172"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="225.5449" x="27" y="704.6123">PortfolioStockOperationsService</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="Port" id="part2-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="100.3447" x="289.5449" y="19.7031"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="296.5449" y="39.6982">PortfolioPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6025" x="302.916" y="55.9951">(Interface)</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="Port" id="part2-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="100.3447" x="289.5449" y="684.6172"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="296.5449" y="704.6123">PortfolioPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6025" x="302.916" y="720.9092">(Interface)</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="Adapter" id="part3-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="149.4746" x="442.8516" y="19.7031"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135.4746" x="449.8516" y="39.6982">JpaPortfolioAdapter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.3594" x="458.9092" y="55.9951">(Driven Adapter)</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="Adapter" id="part3-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="149.4746" x="442.8516" y="684.6172"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135.4746" x="449.8516" y="704.6123">JpaPortfolioAdapter</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.3594" x="458.9092" y="720.9092">(Driven Adapter)</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="Mapper" id="part4-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.8926" x="622.3262" y="36"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.8926" x="629.3262" y="55.9951">PortfolioMapper</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="Mapper" id="part4-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.8926" x="622.3262" y="684.6172"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.8926" x="629.3262" y="704.6123">PortfolioMapper</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="Repo" id="part5-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="147.1641" x="777.2188" y="19.7031"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="133.1641" x="784.2188" y="39.6982">PortfolioRepository</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="33.0723" x="834.2646" y="55.9951">(JPA)</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="Repo" id="part5-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="147.1641" x="777.2188" y="684.6172"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="133.1641" x="784.2188" y="704.6123">PortfolioRepository</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="33.0723" x="834.2646" y="720.9092">(JPA)</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="DB" id="part6-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="944.3828" y="63.9951">PostgreSQL</text><path d="M969.7593,15 C969.7593,5 987.7593,5 987.7593,5 C987.7593,5 1005.7593,5 1005.7593,15 L1005.7593,41 C1005.7593,51 987.7593,51 987.7593,51 C987.7593,51 969.7593,51 969.7593,41 L969.7593,15" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M969.7593,15 C969.7593,25 987.7593,25 987.7593,25 C987.7593,25 1005.7593,25 1005.7593,15" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="DB" id="part6-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="944.3828" y="697.6123">PostgreSQL</text><path d="M969.7593,710.9141 C969.7593,700.9141 987.7593,700.9141 987.7593,700.9141 C987.7593,700.9141 1005.7593,700.9141 1005.7593,710.9141 L1005.7593,736.9141 C1005.7593,746.9141 987.7593,746.9141 987.7593,746.9141 C987.7593,746.9141 969.7593,746.9141 969.7593,736.9141 L969.7593,710.9141" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M969.7593,710.9141 C969.7593,720.9141 987.7593,720.9141 987.7593,720.9141 C987.7593,720.9141 1005.7593,720.9141 1005.7593,710.9141" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="488.6563" style="stroke:#000000;stroke-width:1;" width="10" x="334.7173" y="98.4297"/></g><g><title>JpaPortfolioAdapter</title><rect fill="#FFFFFF" height="364.9922" style="stroke:#000000;stroke-width:1;" width="10" x="512.5889" y="192.9609"/></g><g><title>PortfolioMapper</title><rect fill="#FFFFFF" height="139.9297" style="stroke:#000000;stroke-width:1;" width="10" x="679.7725" y="272.3594"/></g><g><title>PortfolioRepository</title><rect fill="#FFFFFF" height="87.3984" style="stroke:#000000;stroke-width:1;" width="10" x="845.8008" y="441.4219"/></g><g><title>PostgreSQL</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="982.7593" y="470.5547"/></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="322.7173,94.4297,332.7173,98.4297,322.7173,102.4297,326.7173,98.4297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="139.7725" x2="328.7173" y1="98.4297" y2="98.4297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.8716" x="146.7725" y="93.3638">savePortfolio(portfolio)</text></g><path d="M349,111.4297 L349,166.4297 L523,166.4297 L523,121.4297 L513,111.4297 L349,111.4297" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M513,111.4297 L513,121.4297 L523,121.4297 L513,111.4297" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.2671" x="355" y="128.4966">Service depends on</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="21.3345" x="355" y="143.6294">the</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.1045" x="380.4668" y="143.6294">interface</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="446.5713" y="143.6294">,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.8926" x="355" y="158.7622">not the implementation</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#000000" points="500.5889,188.9609,510.5889,192.9609,500.5889,196.9609,504.5889,192.9609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="344.7173" x2="506.5889" y1="192.9609" y2="192.9609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.8716" x="351.7173" y="187.895">savePortfolio(portfolio)</text></g><path d="M527,205.9609 L527,245.9609 L680,245.9609 L680,215.9609 L670,205.9609 L527,205.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M670,205.9609 L670,215.9609 L680,215.9609 L670,205.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.8438" x="533" y="223.0278">Adapter implements</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.2261" x="533" y="238.1606">the port interface</text><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg3"><polygon fill="#000000" points="667.7725,268.3594,677.7725,272.3594,667.7725,276.3594,671.7725,272.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="522.5889" x2="673.7725" y1="272.3594" y2="272.3594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.502" x="529.5889" y="267.2935">toEntity(portfolio)</text></g><path d="M694,285.3594 L694,385.3594 L879,385.3594 L879,295.3594 L869,285.3594 L694,285.3594" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M869,285.3594 L869,295.3594 L879,295.3594 L869,285.3594" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.8335" x="700" y="302.4263">Convert domain model</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="79.6187" x="700" y="317.5591">to JPA entity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="700" y="332.6919">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.9946" x="700" y="347.8247">Portfolio &#8594; PortfolioEntity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.5015" x="700" y="362.9575">Holding &#8594; HoldingEntity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.6968" x="700" y="378.0903">Lot &#8594; LotEntity</text><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg4"><polygon fill="#000000" points="533.5889,408.2891,523.5889,412.2891,533.5889,416.2891,529.5889,412.2891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="527.5889" x2="683.7725" y1="412.2891" y2="412.2891"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.895" x="539.5889" y="407.2231">PortfolioEntity</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg5"><polygon fill="#000000" points="833.8008,437.4219,843.8008,441.4219,833.8008,445.4219,837.8008,441.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="522.5889" x2="839.8008" y1="441.4219" y2="441.4219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.8818" x="529.5889" y="436.356">save(portfolioEntity)</text></g><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg6"><polygon fill="#000000" points="970.7593,466.5547,980.7593,470.5547,970.7593,474.5547,974.7593,470.5547" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="855.8008" x2="976.7593" y1="470.5547" y2="470.5547"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="103.7905" x="862.8008" y="465.4888">INSERT/UPDATE</text></g><g class="message" data-entity-1="part6" data-entity-2="part5" id="msg7"><polygon fill="#000000" points="866.8008,495.6875,856.8008,499.6875,866.8008,503.6875,862.8008,499.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="860.8008" x2="986.7593" y1="499.6875" y2="499.6875"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="88.4482" x="872.8008" y="494.6216">rows affected</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg8"><polygon fill="#000000" points="533.5889,524.8203,523.5889,528.8203,533.5889,532.8203,529.5889,528.8203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="527.5889" x2="849.8008" y1="528.8203" y2="528.8203"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.895" x="539.5889" y="523.7544">PortfolioEntity</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg9"><polygon fill="#000000" points="355.7173,553.9531,345.7173,557.9531,355.7173,561.9531,351.7173,557.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="349.7173" x2="516.5889" y1="557.9531" y2="557.9531"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="27.5107" x="361.7173" y="552.8872">void</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg10"><polygon fill="#000000" points="150.7725,583.0859,140.7725,587.0859,150.7725,591.0859,146.7725,587.0859" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="144.7725" x2="338.7173" y1="587.0859" y2="587.0859"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="27.5107" x="156.7725" y="582.02">void</text></g><path d="M55,600.0859 L55,670.0859 L1071,670.0859 L1071,610.0859 L1061,600.0859 L55,600.0859" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1061,600.0859 L1061,610.0859 L1071,610.0859 L1061,600.0859" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="236.2725" x="417.2246" y="617.1528">Hexagonal Architecture Benefit:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="235.8535" x="417.2246" y="632.2856">The service doesn't know about JPA,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="254.8774" x="417.2246" y="647.4185">Hibernate, or SQL. It could be swapped</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="282.6865" x="417.2246" y="662.5513">for MongoDB, Redis, or in-memory storage.</text><?plantuml-src ZLJ1Rjim3BtxAxZkiDP8kdiE0v8wGrAqMzTajrqKYtQ4sA8XASxw0_k0VUA-P9HaEqct04M2X2Rvg4VoMU_S5ck4fX9A9tQdT2ECg64ZybrfQA_b7LLauFtdkVya2OUTobKZj8Eh9pAke4hHob6--zgW4KwHjYiqhShn2eI5phu0zCOFVRtK3aqXShm96Eyz1zmtOi1CfMWudM6PKIrgw1mHsprSEEzHDCmo94RpGjupDcIL8_F2nzm_JMDjxqsaS68ZBFfiwqg3gsyF8PhDagJh5iQVGXCJiAB5eUfrqritYSYTQeN3sAmcjemgjmweY2xeHmSI6zJI0cbsyhuWJLK_i3GTiPFX8Q3gfk9rQXVsa33AXp19V4LFgflEMtZrWpodrdkXjuvdsewTBmO3mHCIFO9vnE5FmD5SE-LU_ikWsz0vWSu9S4UwHJv9KitQXPeaLfu10UyBC9JbP_uEVSAVNx-FJ_C-PK6LLBeCqSuUOWyyMU_d_yutz1EPmFXqhA-BItpTpUaKl9xYAexzH-3958Be4l_h8Tbi0iilg_dp-kFtfsowdXyJMN_PBD29TGqTB8YYmDoXF6NYXHhhlP5wf30G7yJTaZeht8kZanldTHB-DpL8FAwMU8rzuiYJ0nRu0d-AahIeO6hohNBSnDuWp51ZeTmaJJbhpMAp_Jj2QFK71pjD1n0RsZil0_zkBDG6ZUOpHy0N6R-ijx1qaDE-ah3X0WU_5yc91OSVIPUKpKRSibGs89GUrrZpJG2MxmDHukrH0dy1?></g></svg>