<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="742px" preserveAspectRatio="none" style="width:1028px;height:742px;background:#FEFEFE;" version="1.1" viewBox="0 0 1028 742" width="1028px" zoomAndPan="magnify"><defs/><g><rect fill="#FEFEFE" height="742" style="stroke:none;stroke-width:1;" width="1028" x="0" y="0"/><g><title>PortfolioStockOperationsService</title><rect fill="#FFFFFF" height="610.1875" style="stroke:#000000;stroke-width:1;" width="10" x="134.7725" y="62.5938"/></g><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="411.3354" y="83.7266"/></g><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="411.3354" y="483.8516"/></g><g><title>StockPriceProviderPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="594.0161" y="184.125"/></g><g><title>Portfolio</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="778.3169" y="425.5859"/></g><g><title>TransactionPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="941.7065" y="614.5156"/></g><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="Service" id="part1-lifeline"><g><title>PortfolioStockOperationsService</title><rect fill="#000000" fill-opacity="0.00000" height="638.1875" width="8" x="135.7725" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="139" x2="139" y1="52.5938" y2="690.7813"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="PortfolioPort" id="part2-lifeline"><g><title>PortfolioPort</title><rect fill="#000000" fill-opacity="0.00000" height="638.1875" width="8" x="412.3354" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="415.4507" x2="415.4507" y1="52.5938" y2="690.7813"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="PricePort" id="part3-lifeline"><g><title>StockPriceProviderPort</title><rect fill="#000000" fill-opacity="0.00000" height="638.1875" width="8" x="595.0161" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="598.2202" x2="598.2202" y1="52.5938" y2="690.7813"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="Portfolio" id="part4-lifeline"><g><title>Portfolio</title><rect fill="#000000" fill-opacity="0.00000" height="638.1875" width="8" x="779.3169" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="782.812" x2="782.812" y1="52.5938" y2="690.7813"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="TransactionPort" id="part5-lifeline"><g><title>TransactionPort</title><rect fill="#000000" fill-opacity="0.00000" height="638.1875" width="8" x="942.7065" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="945.8218" x2="945.8218" y1="52.5938" y2="690.7813"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="Service" id="part1-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="239.5449" x="20" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="225.5449" x="27" y="24.9951">PortfolioStockOperationsService</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="145.3389" x="67.103" y="41.292">(Application Service)</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="Service" id="part1-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="239.5449" x="20" y="689.7813"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="225.5449" x="27" y="709.7764">PortfolioStockOperationsService</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="145.3389" x="67.103" y="726.0732">(Application Service)</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="PortfolioPort" id="part2-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.7695" x="350.4507" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="373.1631" y="24.9951">PortfolioPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="357.4507" y="41.292">(Secondary Port)</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="PortfolioPort" id="part2-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.7695" x="350.4507" y="689.7813"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="373.1631" y="709.7764">PortfolioPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="357.4507" y="726.0732">(Secondary Port)</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="PricePort" id="part3-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="173.5918" x="512.2202" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="159.5918" x="519.2202" y="24.9951">StockPriceProviderPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="540.1313" y="41.292">(Secondary Port)</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="PricePort" id="part3-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="173.5918" x="512.2202" y="689.7813"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="159.5918" x="519.2202" y="709.7764">StockPriceProviderPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="540.1313" y="726.0732">(Secondary Port)</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="Portfolio" id="part4-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="135.0098" x="715.812" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58.0918" x="754.271" y="24.9951">Portfolio</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="121.0098" x="722.812" y="41.292">(Aggregate Root)</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="Portfolio" id="part4-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="135.0098" x="715.812" y="689.7813"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58.0918" x="754.271" y="709.7764">Portfolio</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="121.0098" x="722.812" y="726.0732">(Aggregate Root)</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="TransactionPort" id="part5-head"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.7695" x="880.8218" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.4004" x="891.5063" y="24.9951">TransactionPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="887.8218" y="41.292">(Secondary Port)</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="TransactionPort" id="part5-tail"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.7695" x="880.8218" y="689.7813"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.4004" x="891.5063" y="709.7764">TransactionPort</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.7695" x="887.8218" y="726.0732">(Secondary Port)</text></g><g><title>PortfolioStockOperationsService</title><rect fill="#FFFFFF" height="610.1875" style="stroke:#000000;stroke-width:1;" width="10" x="134.7725" y="62.5938"/></g><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="411.3354" y="83.7266"/></g><g><title>PortfolioPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="411.3354" y="483.8516"/></g><g><title>StockPriceProviderPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="594.0161" y="184.125"/></g><g><title>Portfolio</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="778.3169" y="425.5859"/></g><g><title>TransactionPort</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="941.7065" y="614.5156"/></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="399.3354,79.7266,409.3354,83.7266,399.3354,87.7266,403.3354,83.7266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="405.3354" y1="83.7266" y2="83.7266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180.1592" x="151.7725" y="78.6606">getPortfolioById(PortfolioId)</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg2"><polygon fill="#000000" points="155.7725,108.8594,145.7725,112.8594,155.7725,116.8594,151.7725,112.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="149.7725" x2="415.3354" y1="112.8594" y2="112.8594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130.6919" x="161.7725" y="107.7935">Optional&lt;Portfolio&gt;</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg3"><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="186.7725" y1="141.9922" y2="141.9922"/><line style="stroke:#000000;stroke-width:1;" x1="186.7725" x2="186.7725" y1="141.9922" y2="154.9922"/><line style="stroke:#000000;stroke-width:1;" x1="145.7725" x2="186.7725" y1="154.9922" y2="154.9922"/><polygon fill="#000000" points="155.7725,150.9922,145.7725,154.9922,155.7725,158.9922,151.7725,154.9922" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="220.4795" x="151.7725" y="136.9263">portfolio = optional.orElseThrow()</text></g><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg4"><polygon fill="#000000" points="582.0161,180.125,592.0161,184.125,582.0161,188.125,586.0161,184.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="588.0161" y1="184.125" y2="184.125"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.6934" x="151.7725" y="179.0591">fetchStockPrice(Ticker)</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg5"><polygon fill="#000000" points="155.7725,209.2578,145.7725,213.2578,155.7725,217.2578,151.7725,213.2578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="149.7725" x2="598.0161" y1="213.2578" y2="213.2578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="67.9199" x="161.7725" y="208.1919">StockPrice</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg6"><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="186.7725" y1="242.3906" y2="242.3906"/><line style="stroke:#000000;stroke-width:1;" x1="186.7725" x2="186.7725" y1="242.3906" y2="255.3906"/><line style="stroke:#000000;stroke-width:1;" x1="145.7725" x2="186.7725" y1="255.3906" y2="255.3906"/><polygon fill="#000000" points="155.7725,251.3906,145.7725,255.3906,155.7725,259.3906,151.7725,255.3906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="200.6558" x="151.7725" y="237.3247">Price price = stockPrice.price()</text></g><path d="M149,268.3906 L149,399.3906 L375,399.3906 L375,278.3906 L365,268.3906 L149,268.3906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M365,268.3906 L365,278.3906 L375,278.3906 L365,268.3906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="74.877" x="155" y="285.4575">The service</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.0249" x="234.0093" y="285.4575">orchestrates</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.3799" x="327.0342" y="285.4575">:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158.1328" x="155" y="300.5903">1. Fetch data from ports</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.8926" x="155" y="315.7231">2. Extract Price from StockPrice</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.0098" x="155" y="330.856">3. Call the aggregate root</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.4146" x="155" y="345.9888">4. Save results</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="155" y="361.1216">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.4575" x="155" y="376.2544">It does NOT contain</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.5796" x="155" y="391.3872">business logic!</text><g class="message" data-entity-1="part1" data-entity-2="part4" id="msg7"><polygon fill="#000000" points="766.3169,421.5859,776.3169,425.5859,766.3169,429.5859,770.3169,425.5859" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="772.3169" y1="425.5859" y2="425.5859"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="214.1572" x="151.7725" y="420.52">sell(Ticker, ShareQuantity, Price)</text></g><g class="message" data-entity-1="part4" data-entity-2="part1" id="msg8"><polygon fill="#000000" points="155.7725,450.7188,145.7725,454.7188,155.7725,458.7188,151.7725,454.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="149.7725" x2="782.3169" y1="454.7188" y2="454.7188"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="220.2002" x="161.7725" y="449.6528">SellResult(Money, Money, Money)</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg9"><polygon fill="#000000" points="399.3354,479.8516,409.3354,483.8516,399.3354,487.8516,403.3354,483.8516" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="405.3354" y1="483.8516" y2="483.8516"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.8716" x="151.7725" y="478.7856">savePortfolio(portfolio)</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg10"><polygon fill="#000000" points="155.7725,508.9844,145.7725,512.9844,155.7725,516.9844,151.7725,512.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="149.7725" x2="415.3354" y1="512.9844" y2="512.9844"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="27.5107" x="161.7725" y="507.9185">void</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg11"><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="186.7725" y1="572.3828" y2="572.3828"/><line style="stroke:#000000;stroke-width:1;" x1="186.7725" x2="186.7725" y1="572.3828" y2="585.3828"/><line style="stroke:#000000;stroke-width:1;" x1="145.7725" x2="186.7725" y1="585.3828" y2="585.3828"/><polygon fill="#000000" points="155.7725,581.3828,145.7725,585.3828,155.7725,589.3828,151.7725,585.3828" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.8638" x="151.7725" y="537.0513">Transaction.createSale(</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="220.2383" x="151.7725" y="552.1841">PortfolioId, Ticker, ShareQuantity,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="242.563" x="151.7725" y="567.3169">Price, Money proceeds, Money profit)</text></g><g class="message" data-entity-1="part1" data-entity-2="part5" id="msg12"><polygon fill="#000000" points="929.7065,610.5156,939.7065,614.5156,929.7065,618.5156,933.7065,614.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="144.7725" x2="935.7065" y1="614.5156" y2="614.5156"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.0103" x="151.7725" y="609.4497">save(transaction)</text></g><g class="message" data-entity-1="part5" data-entity-2="part1" id="msg13"><polygon fill="#000000" points="155.7725,639.6484,145.7725,643.6484,155.7725,647.6484,151.7725,643.6484" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="149.7725" x2="945.7065" y1="643.6484" y2="643.6484"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="27.5107" x="161.7725" y="638.5825">void</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg14"><polygon fill="#000000" points="1015.5913,668.7813,1025.5913,672.7813,1015.5913,676.7813,1019.5913,672.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="139.7725" x2="1021.5913" y1="672.7813" y2="672.7813"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.2256" x="146.7725" y="667.7153">SellResult</text></g><?plantuml-src dLHDZzem4BtdLynkBm6naVfnGjsLsXKhSMYX6uvxyJf3Oc4yaMre-VSTXs2IB8lK2WJsV3o_6R_nZQzmYr1heKpYDihKmeejl0gvAItjJF58cYnyU9g5JvAmsokfQc4yt2x9-ZLfHRadkLdKQ8LNP5oETgyalfZqMrrh9HihjDRHBGXtsho35nQSdQCaKmXxW60u9lPY-kaDYwLbsAMblIhGNiDfujvWHFX0lYmjbi8ZF1CDZ--dhQmmJiXGvvKp1r594jRxSC2f7KcxWBk7VgLJAD57o_V3l4ZZRbwCpaZz_lHsSCUexG5JMDI1Xz1VOyn3Kk0xE5rU4Q4-XS0zK8kMaPrfXwlAqkzqrA_drF4fhD7BwdnTwKh93Tfk5V5sughF_fpS8ntJBX9kt50tl_VW8aJMc09TGunYLLbve7My5O1LXU1QnF6OhApGULOxkl5uolwF6Jo5cg0GNi3QqhRfZcFNfmncVpXM-lRynjlX3_0vWqUXDV0iWeYYiomwTdx981TxtgBRwGQHltCF1Q63duiLiCvyc5w0rvrJ1fq3JQMIDmcQ0a95bsKrvOgqRdi_WRmI5d_jMCxA7oP7hfTqTTRKu4OOxBdXcFuWWmpH_HjTrDOrlJikEfhIgBN_aVgULF6FskwCQYOjSbOkDAOlfZDr4xZSEmuApMihPxsHH2nSPxzMlZyRWvVXM7tgpzPEsSDNPB2_NlgR9oYIuApk9NQJJdFm5m00?></g></svg>